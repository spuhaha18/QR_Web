<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API 문서 - QR 라벨 생성기</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }
        h2 {
            color: #007bff;
            margin-top: 30px;
        }
        .endpoint {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            color: white;
            margin-right: 10px;
        }
        .method.get { background-color: #28a745; }
        .method.post { background-color: #007bff; }
        .code {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 3px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .nav-link {
            color: #007bff;
            text-decoration: none;
            margin-right: 20px;
        }
        .nav-link:hover {
            text-decoration: underline;
        }
        .parameter {
            margin: 5px 0;
        }
        .parameter-name {
            font-weight: bold;
            color: #d73a49;
        }
        .parameter-type {
            color: #6f42c1;
            font-style: italic;
        }
        .required {
            color: #dc3545;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div style="margin-bottom: 30px;">
            <a href="/" class="nav-link">홈으로</a>
            <a href="/logs" class="nav-link">로그 확인</a>
        </div>

        <h1>QR 라벨 생성기 API 문서</h1>
        
        <h2>개요</h2>
        <p>이 API는 QR 코드가 포함된 라벨을 생성하는 서비스입니다. 기기 문서와 과제 문서 두 가지 유형의 라벨을 생성할 수 있습니다.</p>

        <h2>Base URL</h2>
        <div class="code">http://localhost:5000</div>

        <h2>엔드포인트</h2>

        <div class="endpoint">
            <h3><span class="method get">GET</span>/api/health</h3>
            <p>서비스 상태를 확인합니다.</p>
            <h4>응답 예시</h4>
            <div class="code">{
  "status": "healthy",
  "timestamp": "2024-01-01T12:00:00.000000",
  "version": "1.0.0"
}</div>
        </div>

        <div class="endpoint">
            <h3><span class="method post">POST</span>/api/create_label</h3>
            <p>라벨을 생성합니다.</p>
            <h4>요청 헤더</h4>
            <div class="code">Content-Type: application/json</div>
            
            <h4>요청 파라미터</h4>
            <table>
                <tr>
                    <th>필드</th>
                    <th>타입</th>
                    <th>필수</th>
                    <th>설명</th>
                </tr>
                <tr>
                    <td>doc_type</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>"1" (기기 문서) 또는 "2" (과제 문서)</td>
                </tr>
                <tr>
                    <td>binder_size</td>
                    <td>integer</td>
                    <td class="required">필수</td>
                    <td>1, 3, 5, 7 중 하나 (바인더 크기)</td>
                </tr>
            </table>

            <h4>기기 문서 (doc_type: "1") 추가 필드</h4>
            <table>
                <tr>
                    <th>필드</th>
                    <th>타입</th>
                    <th>필수</th>
                    <th>설명</th>
                </tr>
                <tr>
                    <td>eq_number</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>기기 번호</td>
                </tr>
                <tr>
                    <td>eq_doc_number</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>문서 번호</td>
                </tr>
                <tr>
                    <td>eq_doc_title</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>문서 제목</td>
                </tr>
                <tr>
                    <td>eq_doc_count</td>
                    <td>integer</td>
                    <td class="required">필수</td>
                    <td>문서 개수</td>
                </tr>
                <tr>
                    <td>eq_doc_department</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>부서</td>
                </tr>
                <tr>
                    <td>eq_doc_year</td>
                    <td>integer</td>
                    <td class="required">필수</td>
                    <td>연도</td>
                </tr>
            </table>

            <h4>과제 문서 (doc_type: "2") 추가 필드</h4>
            <table>
                <tr>
                    <th>필드</th>
                    <th>타입</th>
                    <th>필수</th>
                    <th>설명</th>
                </tr>
                <tr>
                    <td>pjt_number</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>과제 번호</td>
                </tr>
                <tr>
                    <td>pjt_test_number</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>시험 번호</td>
                </tr>
                <tr>
                    <td>pjt_doc_title</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>문서 제목</td>
                </tr>
                <tr>
                    <td>pjt_doc_writer</td>
                    <td>string</td>
                    <td class="required">필수</td>
                    <td>작성자</td>
                </tr>
                <tr>
                    <td>pjt_doc_count</td>
                    <td>integer</td>
                    <td class="required">필수</td>
                    <td>문서 개수</td>
                </tr>
            </table>

            <h4>요청 예시 (기기 문서)</h4>
            <div class="code">{
  "doc_type": "1",
  "binder_size": 5,
  "eq_number": "EQ001",
  "eq_doc_number": "DOC001",
  "eq_doc_title": "테스트 문서",
  "eq_doc_count": 3,
  "eq_doc_department": "기술부",
  "eq_doc_year": 2024
}</div>

            <h4>요청 예시 (과제 문서)</h4>
            <div class="code">{
  "doc_type": "2",
  "binder_size": 3,
  "pjt_number": "PJT001",
  "pjt_test_number": "TEST001",
  "pjt_doc_title": "과제 문서",
  "pjt_doc_writer": "홍길동",
  "pjt_doc_count": 2
}</div>

            <h4>성공 응답</h4>
            <div class="code">{
  "success": true,
  "message": "라벨이 성공적으로 생성되었습니다.",
  "filename": "DOC001_20240101120000.xlsx",
  "download_url": "/download/DOC001_20240101120000.xlsx"
}</div>
        </div>

        <div class="endpoint">
            <h3><span class="method get">GET</span>/api/qr_image/&lt;qr_text&gt;</h3>
            <p>QR 코드 이미지를 PNG 형식으로 생성합니다.</p>
            <h4>URL 파라미터</h4>
            <div class="parameter">
                <span class="parameter-name">qr_text</span> 
                <span class="parameter-type">(string, 필수)</span>: QR 코드에 포함할 텍스트
            </div>
            <h4>응답</h4>
            <p>PNG 이미지 파일</p>
        </div>

        <div class="endpoint">
            <h3><span class="method post">POST</span>/api/qr_image_base64</h3>
            <p>QR 코드 이미지를 base64 형식으로 생성합니다.</p>
            <h4>요청 파라미터</h4>
            <div class="code">{
  "text": "QR 코드에 포함할 텍스트"
}</div>
            <h4>응답 예시</h4>
            <div class="code">{
  "success": true,
  "image_base64": "iVBORw0KGgoAAAANSUhEUgAA...",
  "mime_type": "image/png"
}</div>
        </div>

        <div class="endpoint">
            <h3><span class="method get">GET</span>/download/&lt;filename&gt;</h3>
            <p>생성된 파일을 다운로드합니다.</p>
            <h4>URL 파라미터</h4>
            <div class="parameter">
                <span class="parameter-name">filename</span> 
                <span class="parameter-type">(string, 필수)</span>: 다운로드할 파일명
            </div>
        </div>

        <div class="endpoint">
            <h3><span class="method get">GET</span>/api/logs</h3>
            <p>애플리케이션 로그를 조회합니다.</p>
            <h4>쿼리 파라미터</h4>
            <table>
                <tr>
                    <th>파라미터</th>
                    <th>타입</th>
                    <th>기본값</th>
                    <th>설명</th>
                </tr>
                <tr>
                    <td>lines</td>
                    <td>integer</td>
                    <td>100</td>
                    <td>가져올 로그 줄 수 (최대 1000)</td>
                </tr>
                <tr>
                    <td>level</td>
                    <td>string</td>
                    <td>all</td>
                    <td>로그 레벨 필터</td>
                </tr>
                <tr>
                    <td>search</td>
                    <td>string</td>
                    <td>""</td>
                    <td>검색어</td>
                </tr>
            </table>
        </div>

        <div class="endpoint">
            <h3><span class="method post">POST</span>/api/logs/clear</h3>
            <p>로그 파일을 초기화합니다.</p>
        </div>

        <div class="endpoint">
            <h3><span class="method get">GET</span>/api/logs/download</h3>
            <p>로그 파일을 다운로드합니다.</p>
        </div>

        <h2>오류 응답</h2>
        <p>모든 API 엔드포인트는 오류 발생 시 다음과 같은 형식으로 응답합니다:</p>
        <div class="code">{
  "error": "오류 메시지"
}</div>

        <h2>주의사항</h2>
        <ul>
            <li>과제 문서(doc_type: "2")의 경우 binder_size 1을 사용할 수 없습니다.</li>
            <li>생성된 파일은 10분 후 자동으로 삭제됩니다.</li>
            <li>모든 텍스트 필드는 개행 문자가 자동으로 제거됩니다.</li>
        </ul>
    </div>
</body>
</html>